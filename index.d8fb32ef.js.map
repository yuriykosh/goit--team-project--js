{"mappings":"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","sources":["src/js/modal.js","src/js/player.js","src/js/modalBtnLogics.js"],"sourcesContent":["import { ApiService } from './ApiServise';\nimport { Notify } from 'notiflix';\nimport { spinnerStart, spinnerStop } from './spinner';\nimport findMovieTrailer from './player';\nimport onBtnClick from './modalBtnLogics';\nimport 'material-icons/iconfont/material-icons.css';\n\nconst closeModalBtn = document.querySelector('[data-modal-close]');\nconst modal = document.querySelector('[data-modal]');\nconst movies = document.querySelector('.movies');\nconst wrapper = document.querySelector('.movie-modal');\n\n// const btnAddToWatched = document.querySelector('.btn_add_watched');\n// const btnAddToQueue = document.querySelector('.btn_add_queue');\n\nmovies.addEventListener('click', clickList);\n\nfunction clickModal(event) {\n  if (event.target.nodeName === 'BUTTON') {\n    return;\n  };\n\n  if (\n    ((!event.target.closest('.movie-modal') ||\n      event.target.closest('[data-modal-close]')) &&\n      !event.keyCode) ||\n    event.keyCode === 27\n  ) {\n    closeModal();\n    document.removeEventListener('keydown', clickModal);\n    modal.removeEventListener('click', clickModal);\n  }\n}\n\nfunction closeModal() {\n  modal.classList.add('is-hidden');\n  document.body.style.overflow = 'visible';\n  const markupWrapper = document.querySelector('.movie-modal__wrapper');\n  modal.removeAttribute(\"id\");\n  markupWrapper.remove();\n  \n}\n\nfunction clickList(event) {\n  const moviesCard = event.target.closest('.movies__item');\n  if (moviesCard) {\n    modal.setAttribute('id', moviesCard.id);\n    // btnAddToWatched.setAttribute('data-id', moviesCard.id);\n    // btnAddToQueue.setAttribute('data-id', moviesCard.id);\n    openModal(moviesCard.id);\n  }\n}\n\nfunction openModal(id) {\n  modal.classList.remove('is-hidden');\n  document.body.style.overflow = 'hidden';\n  fetchModalMarkup(id);\n  modal.addEventListener('click', clickModal);\n  document.addEventListener('keydown', clickModal);\n}\n\nasync function fetchModalMarkup(id) {\n  try {\n    spinnerStart();\n    const response = await ApiService.getMoviesById(id);\n    const { data } = response;\n\n    const markUp = createModalMarkup(data);\n    wrapper.insertAdjacentHTML('beforeend', markUp);\n\n    const btnAddToWatched = document.querySelector('.btn_add_watched');\n    const btnAddToQueue = document.querySelector('.btn_add_queue');\n    btnAddToWatched.addEventListener('click', (event) => onBtnClick(event, 'WATCHED'));\n    btnAddToQueue.addEventListener('click', (event) => onBtnClick(event, 'QUEUE'));\n    const playBtn = document.querySelector('.js-playBtn');\n    playBtn.addEventListener('click', onPlayTrailer);\n  } catch (error) {\n    console.log(error);\n    return Notify.failure('Something went wrong. Please try again later.');\n  } finally {\n    spinnerStop();\n  }\n}\n\nfunction createModalMarkup(data) {\n  const {genres, poster_path, title, vote_average, id, vote_count, popularity, original_title, overview} = data;\n  let watchedText = '';\n  let queueText = '';\n  // const x = JSON.parse(localStorage.getItem('WATCHED'));\n  // console.log(x);\n  // const storageArray = !JSON.parse(localStorage.getItem('WATCHED')) ? [JSON.parse(localStorage.getItem('WATCHED'))] : [];\n\n  // console.log(storageArray);\n  // if (!storageArray) {\n  //   watchedText = 'add to watched';\n  // } else {\n  //   watchedText = !storageArray.find(item => Number(item) === id) ? \"add to watched\" : \"remove from watched\";\n  // }\n\n  // const queueArray = !JSON.parse(localStorage.getItem('QUEUE')) ? [JSON.parse(localStorage.getItem('QUEUE'))] : [];\n  // if (!queueArray) {\n  //   queueText = 'add to watched';\n  // } else {\n  //   queueText = !queueArray.find(item => Number(item) === id) ? \"add to queue\" : \"remove from queue\";\n  // }\n\n  const defaultImage = `https://raw.githubusercontent.com/yuriykosh/goit--team-project--js/main/src/images/main-home/poster-filler-desktop.jpeg`;\n  const posterLink = `https://image.tmdb.org/t/p/w500/${poster_path}`;\n  const genresList = genres.map(genre => genre.name);\n  const genresItems = genresList.length > 2 ? [genresList[0], genresList[1], 'Other'].join(', ') : genresList.join(', ');\n  const voteAverage = vote_average.toFixed(1);\n  const popul = popularity.toFixed(1);\n\n  return `<div class=\"movie-modal__wrapper\">\n    <div class=\"movie-modal__imgBox\">\n    <button class=\"movie-modal__video-btn js-playBtn\">\n      <span class=\"material-icons-round\" style=\"font-size: 80px\">play_circle</span>\n    </button>\n    <img class=\"movie-modal__imgBox__img\" src=${posterLink}\n      alt=${title} onerror=\"this.onerror=null;this.src='${defaultImage}';\"/>\n  </div>\n  <div>\n    <div>\n      <h2 class=\"movie-modal__title\">${title}</h2>\n      <ul class=\"movie-modal__info\">\n        <li class=\"movie-modal__info__item\">\n          <p class=\"movie-modal__info__item__attribute\">Vote / Votes</p>\n          <p class=\"movie-modal__info__item__value\">\n            <span class=\"movie-modal__info__item__value__marker\">${voteAverage}</span><span\n              class=\"movie-modal__info__item__value-slash\">/</span>\n            <span class=\"movie-modal__info__item__value__marker--grey\">${vote_count}</span>\n          </p>\n        </li>\n        <li class=\"movie-modal__info__item\">\n          <p class=\"movie-modal__info__item__attribute\">Popularity</p>\n          <p class=\"movie-modal__info__item__value\">${popul}</p>\n        </li>\n        <li class=\"movie-modal__info__item\">\n          <p class=\"movie-modal__info__item__attribute\">Original Title</p>\n          <p class=\"movie-modal__info__item__value\">${original_title}</p>\n        </li>\n        <li class=\"movie-modal__info__item\">\n          <p class=\"movie-modal__info__item__attribute\">Genre</p>\n          <p class=\"movie-modal__info__item__value\">${genresItems}</p>\n        </li>\n      </ul>\n    </div>\n    <div class=\"movie-modal__about\">\n      <h3 class=\"movie-modal__about-title\">About</h3>\n      <p class=\"movie-modal__desc\">\n        ${overview}\n      </p>\n    </div>\n    <div class=\"movie-modal__button\">\n      <button id=\"add-to-watched\" class=\"movie-modal__button__item btn_add_watched\" data-id=${id}>\n        ${watchedText}\n      </button>\n      <button id=\"add-to-queue\" class=\"movie-modal__button__item btn_add_queue\" data-id=${id}>\n        ${queueText}\n      </button>\n    </div>\n  </div>\n</div>`\n}\n\nfunction onPlayTrailer(event) {\n  const moviesId = event.target.closest('[data-modal]').id;\n  findMovieTrailer(moviesId);\n}","import { ApiService } from './ApiServise';\nimport { Notify } from 'notiflix';\n\nconst player = document.querySelector('.player');\nconst modal = document.querySelector('[data-modal]');\n\nmodal.addEventListener('click', onClose);\n\nexport default async function findMovieTrailer(id) {\n    try {\n      const response = await ApiService.getMovieTreiler(id);\n      const { data } = response;\n  \n      const videoKey = data.results.find(\n        result => result.type === 'Trailer' && result.official\n      ).key;\n      videoID = videoKey;\n  \n      createPlayer(videoID);\n      \n      window.addEventListener('keydown', onEscPress)\n  \n    } catch (error) {\n      console.log(error);\n      return Notify.failure('Something went wrong. Please try again later.');\n    }\n  }\n  \n  function createPlayer (id) {\n    const frame = `<iframe class=\"player__frame\" id=\"player\" type=\"text/html\"\n    src=\"http://www.youtube.com/embed/${id}?enablejsapi=1&origin=http://example.com\"frameborder=\"0\"></iframe>`;\n    player.innerHTML = frame;\n  }\n\n  function onEscPress(e) {\n    if (e.key !== 'Escape') {\n      return\n    }\n    player.innerHTML = '';\n    window.removeEventListener('keydown', onEscPress)\n  }\n\n  function onClose(e) {\n    if (e.target !== player) {\n      player.innerHTML = '';\n    }\n  }\n","const onBtnClick = function (event, storageKey) {\n    let text = event.target.textContent;\n    const movieId = event.target.dataset.id;\n    // let queueMovie = [JSON.parse(localStorage.getItem(storageKey))];\n    if(!queueMovie){\n        queueMovie = [];\n    }\n\n    if (event.target.textContent.includes('add to')) {\n        event.target.textContent = text.replace('add to', 'remove from');\n        queueMovie = [...queueMovie, \"movieId\"];\n        // localStorage.removeItem(storageKey);\n        // localStorage.setItem(storageKey, queueMovie);\n    } else{\n        event.target.textContent = text.replace('remove from', 'add to');\n        queueMovie = queueMovie.filter((item) => {item !== movieId})\n        // localStorage.removeItem(storageKey);\n        // localStorage.setItem(storageKey, queueMovie);\n    }\n\n\n    // if (tempMovie){\n    //     return;\n    // };\n    \n    // queueMovie.push(movieId);\n    \n    // localStorage.setItem(storageKey, JSON.stringify(queueMovie));\n\n\n\n  \n    // let localWatched = JSON.parse(localStorage.getItem('WATCHED'));\n    // if (!localWatched) {\n    //   watchedText = 'add to watched';\n    // } else {\n    //   watchedText = !localWatched.find(item => Number(item) === id) ? \"add to watched\" : \"remove from watched\";\n    // }\n  \n    // let localQueue = JSON.parse(localStorage.getItem('QUEUE'));\n    // if (!localQueue) {\n    //   queueText = 'add to watched';\n    // } else {\n    //   queueText = !localQueue.find(item => Number(item) === id) ? \"add to queue\" : \"remove from queue\";\n    // }\n}; \n\n// btnAddToWatched.addEventListener('click', (event) => onBtnClick(event, 'WATCHED'));\n// btnAddToQueue.addEventListener('click', (event) => onBtnClick(event, 'QUEUE'));\n\nexport default onBtnClick;"],"names":["$cnvsZ","parcelRequire","$03ce2d03a8d35791$var$player","document","querySelector","async","$03ce2d03a8d35791$export$2e2bcd8739ae039","id","response","ApiService","getMovieTreiler","data","videoKey","results","find","result","type","official","key","videoID","frame","innerHTML","$03ce2d03a8d35791$var$createPlayer","window","addEventListener","$03ce2d03a8d35791$var$onEscPress","error","console","log","$7Y9D8","Notify","failure","e","removeEventListener","target","$510df70f595ddf45$export$2e2bcd8739ae039","event","storageKey","text","textContent","dataset","queueMovie","includes","replace","filter","item","$8a7e756c566dd1ea$var$modal","$8a7e756c566dd1ea$var$movies","$8a7e756c566dd1ea$var$wrapper","$8a7e756c566dd1ea$var$clickModal","nodeName","closest","keyCode","classList","add","body","style","overflow","markupWrapper","removeAttribute","remove","$8a7e756c566dd1ea$var$closeModal","$8a7e756c566dd1ea$var$onPlayTrailer","moviesCard","setAttribute","$04jNI","spinnerStart","getMoviesById","markUp","genres","poster_path","title","vote_average","vote_count","popularity","original_title","overview","watchedText","queueText","defaultImage","posterLink","genresList","map","genre","name","genresItems","length","join","voteAverage","toFixed","popul","$8a7e756c566dd1ea$var$createModalMarkup","insertAdjacentHTML","btnAddToWatched","btnAddToQueue","spinnerStop","$8a7e756c566dd1ea$var$fetchModalMarkup"],"version":3,"file":"index.d8fb32ef.js.map"}